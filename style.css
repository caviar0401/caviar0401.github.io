:root{
  --bg: #f6d89a;
  --bg2:#f2c57c;
  --red:#e8473b;
  --red2:#c73027;
  --jar:#d79b55;
  --jar2:#c78541;
  --white:#fff;
  --text:#111;
}

*{ box-sizing:border-box; }
body{
  margin:0;
  font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", "Noto Sans TC", "Segoe UI", Roboto, Arial, sans-serif;
  color:var(--text);
  background: radial-gradient(ellipse at top, var(--bg), var(--bg2));
}

.page{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:24px 16px 40px;
}

.header{
  width:min(520px, 100%);
  display:flex;
  justify-content:center;
  margin-top:8px;
}

.titleBox{
  background:var(--white);
  border:14px solid var(--red);
  border-radius:10px;
  padding:18px 22px;
  font-size:38px;
  font-weight:900;
  letter-spacing:1px;
  text-align:center;
  box-shadow: 0 10px 25px rgba(0,0,0,.12);
}

.home{
  width:min(520px, 100%);
  display:flex;
  flex-direction:column;
  align-items:center;
  margin-top:28px;
  gap:18px;
}

.jarWrap{
  position:relative;
  width:320px;
  height:420px;
  display:flex;
  align-items:flex-end;
  justify-content:center;
}

.sticks{
  position:absolute;
  top:20px;
  width:200px;
  height:160px;
  display:flex;
  gap:10px;
  justify-content:center;
  align-items:flex-end;
  filter: drop-shadow(0 10px 10px rgba(0,0,0,.08));
}
.sticks span{
  display:block;
  width:24px;
  height:140px;
  background: linear-gradient(#ffe5a8, #f6c879);
  border-radius:10px 10px 6px 6px;
  border:2px solid rgba(0,0,0,.08);
  transform-origin: bottom;
}
.sticks span:nth-child(1){ transform: rotate(-10deg); height:135px;}
.sticks span:nth-child(2){ transform: rotate(-4deg); height:145px;}
.sticks span:nth-child(3){ transform: rotate(0deg); height:150px;}
.sticks span:nth-child(4){ transform: rotate(5deg); height:142px;}
.sticks span:nth-child(5){ transform: rotate(12deg); height:132px;}

.jar{
  width:280px;
  height:300px;
  background: linear-gradient(var(--jar), var(--jar2));
  border-radius: 14px 14px 20px 20px;
  border:10px solid rgba(255,255,255,.65);
  box-shadow: 0 18px 40px rgba(0,0,0,.18);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

.jar::before{
  content:"";
  position:absolute;
  top:-18px;
  left:50%;
  transform:translateX(-50%);
  width:300px;
  height:50px;
  background:#e9e9e9;
  border-radius: 16px;
  box-shadow: inset 0 -10px 0 rgba(0,0,0,.08);
}

.sealBtn{
  width:140px;
  height:140px;
  border-radius:999px;
  border:6px solid var(--red2);
  background: radial-gradient(circle at 30% 30%, #ffd07a, #f1a14b);
  color:#8a1d16;
  font-weight:900;
  font-size:34px;
  line-height:1.05;
  cursor:pointer;
  box-shadow: 0 14px 30px rgba(0,0,0,.20);
  transition: transform .08s ease;
}
.sealBtn:active{ transform: scale(.98); }

.shareBtn{
  width:min(360px, 92%);
  height:58px;
  border-radius:999px;
  border:none;
  background: rgba(255,255,255,.70);
  font-size:22px;
  font-weight:800;
  cursor:pointer;
  box-shadow: 0 12px 24px rgba(0,0,0,.10);
}

.footerNote{
  margin:0;
  opacity:.7;
  font-size:14px;
}

.hidden{ display:none; }

.result{
  width:min(520px, 100%);
  margin-top:24px;
}

.card{
  background: rgba(255,255,255,.85);
  border-radius:18px;
  padding:20px 18px;
  box-shadow: 0 18px 40px rgba(0,0,0,.15);
}

.cardTitle{
  font-size:22px;
  font-weight:900;
  margin-bottom:12px;
}

.poem{
  background: rgba(255,255,255,.7);
  border-radius:14px;
  padding:14px 12px;
  font-size:18px;
  line-height:1.65;
  margin-bottom:12px;
}

.explain{
  font-size:16px;
  line-height:1.7;
  opacity:.92;
}

.actions{
  display:flex;
  gap:10px;
  margin-top:18px;
}

.primary, .ghost{
  flex:1;
  height:48px;
  border-radius:12px;
  font-weight:800;
  font-size:16px;
  cursor:pointer;
}

.primary{
  border:none;
  background: var(--red);
  color:#fff;
}

.ghost{
  background: transparent;
  border:2px solid rgba(0,0,0,.18);
}

/* ===== 抽籤動畫狀態 ===== */
.jarWrap.is-animating .jar{
  animation: jarShake 0.6s infinite ease-in-out;
}

.jarWrap.is-animating .sticks span{
  animation: stickBounce 0.35s infinite ease-in-out;
}

/* 每支籤枝錯開時間，感覺更像在晃 */
.jarWrap.is-animating .sticks span:nth-child(1){ animation-delay: 0s; }
.jarWrap.is-animating .sticks span:nth-child(2){ animation-delay: 0.06s; }
.jarWrap.is-animating .sticks span:nth-child(3){ animation-delay: 0.12s; }
.jarWrap.is-animating .sticks span:nth-child(4){ animation-delay: 0.18s; }
.jarWrap.is-animating .sticks span:nth-child(5){ animation-delay: 0.24s; }

.jarWrap.is-animating .sealBtn{
  cursor: not-allowed;
  opacity: .92;
  transform: scale(0.99);
  filter: saturate(0.95);
}

/* 5 秒內加個光暈感 */
.jarWrap.is-animating .jar::after{
  content:"";
  position:absolute;
  inset:-14px;
  border-radius: 24px;
  background: radial-gradient(circle at 50% 30%, rgba(255,255,255,.25), transparent 55%);
  animation: glowPulse 0.9s infinite ease-in-out;
  pointer-events:none;
}

@keyframes jarShake{
  0%   { transform: translateX(0) rotate(0deg); }
  25%  { transform: translateX(-1px) rotate(-0.6deg); }
  50%  { transform: translateX(1px) rotate(0.6deg); }
  75%  { transform: translateX(-0.5px) rotate(-0.3deg); }
  100% { transform: translateX(0) rotate(0deg); }
}

@keyframes stickBounce{
  0%   { transform: translateY(0) rotate(var(--r,0deg)); }
  50%  { transform: translateY(-14px) rotate(var(--r,0deg)); }
  100% { transform: translateY(0) rotate(var(--r,0deg)); }
}

@keyframes glowPulse{
  0%   { opacity: .35; transform: scale(0.98); }
  50%  { opacity: .7;  transform: scale(1.02); }
  100% { opacity: .35; transform: scale(0.98); }
}

/* 讓籤枝保留原本旋轉角度（用 CSS 變數存） */
.sticks span:nth-child(1){ --r: -10deg; }
.sticks span:nth-child(2){ --r: -4deg; }
.sticks span:nth-child(3){ --r: 0deg; }
.sticks span:nth-child(4){ --r: 5deg; }
.sticks span:nth-child(5){ --r: 12deg; }

.result .card{
  animation: fadeInUp .22s ease-out;
}
@keyframes fadeInUp{
  from { opacity:0; transform: translateY(8px); }
  to   { opacity:1; transform: translateY(0); }
}

/* ===== 收尾停住（減速） ===== */
.jarWrap.is-stopping .jar{
  animation: jarSettle 0.6s forwards ease-out;
}

.jarWrap.is-stopping .sticks span{
  animation: stickSettle 0.6s forwards ease-out;
}

/* 收尾的關鍵影格（幅度更小，慢慢歸零） */
@keyframes jarSettle{
  0%   { transform: translateX(1px) rotate(0.3deg); }
  40%  { transform: translateX(-0.5px) rotate(-0.15deg); }
  70%  { transform: translateX(0.3px) rotate(0.08deg); }
  100% { transform: translateX(0) rotate(0deg); }
}

@keyframes stickSettle{
  0%   { transform: translateY(-6px) rotate(var(--r)); }
  60%  { transform: translateY(2px) rotate(var(--r)); }
  100% { transform: translateY(0) rotate(var(--r)); }
}
